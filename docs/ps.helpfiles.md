# PowerShell

## Creating help documentation from inline / insource comments

See this article on [comments-based help documentation on Microsoft Technet](https://msdn.microsoft.com/powershell/reference/5.1/Microsoft.PowerShell.Core/about/about_Comment_Based_Help)

### Format

Consists of a comment block **dedicated** to help-comments (no other comments in the comment block that are unrelated to the help documentation). And a series of:

```powershell
<#
.<HELP_KEYWORD>
<HELP CONTENT>
...
#>
```

### Location:
- They can be either immediately before a function.
- At the beginning of a script file 
   - preceded only by blank lines and other comments
   - if the next line after a script help block is a function, **there must be at least 2 blank separating lines**

### Topics

* SYNOPSIS
* DESCRIPTION
* PARAMETER (multiple allowed); single line, format:
    ```
    .PARAMETER <parameter name>
    ```
* EXAMPLE
* NOTES
* LINK (multiple allowed); format:
    ```
    .LINK
    <link>
    ```
* COMPONENT
* ROLE (as in the user role required)
* FUNCTIONALITY (intended use)

_these are the headers that are autogenerated_
* NAME
* SYNTAX
* PARAMETER LIST
* COMMON PARAMETERS
* PARAMETER ATTRIBUTE TABLE
* REMARKS

## Over-Riding the auto generated help

The native help topics can be overridden using _here-string_s ; example:

```powershell
Function Get-WmiClasses(
                 $class=($paramMissing=$true),
                 $ns="root\cimv2",
                 [switch]$help
                )
{
  If($help)
   {
    $helpstring = @"
    NAME
      Get-WmiClasses
    SYNOPSIS
      Displays a list of WMI Classes based upon a search criteria
    SYNTAX
     Get-WmiClasses [[-class] [string]] [[-ns] [string]] [-help]
    EXAMPLE
     Get-WmiClasses -class disk -ns root\cimv2"
     This command finds wmi classes that contain the word disk. The
     classes returned are from the root\cimv2 namespace.
"@
   $helpString
     break #exits the function early
   }
  If($local:paramMissing)
    {
      throw "USAGE: Get-WmiClasses -class <class type> -ns <wmi namespace>"
    } #$local:paramMissing
  "`nClasses in $ns namespace ...."
  Get-WmiObject -namespace $ns -list |
  Where-Object {
                 $_.name -match $class -and `
                 $_.name -notlike 'cim*'
               }
  #
} #end get-wmiclasses
```


[source](https://www.microsoftpressstore.com/articles/article.aspx?p=2449030&seqNum=4)


# `helpmessage` on function parameters

**Important note**: the `helpmessage` attribute on function parameters is _not_ applied to comment-based help, and in fact is almost never shown unless the user leaves a mandatory parameter blank.

source: [technet](https://social.technet.microsoft.com/Forums/ie/en-US/35d95d50-4ebf-4d9d-93c1-2034e3566f5b/using-helpmessage-in-parameter-attributes?forum=winserverpowershell)